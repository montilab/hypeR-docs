<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fast Gene Set Enrichment Analysis • hypeR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><link href="../../extra.css" rel="stylesheet">
<meta property="og:title" content="Fast Gene Set Enrichment Analysis">
<meta property="og:description" content="hypeR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">hypeR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.7.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Docs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/docs/installation.html">Installation</a>
    </li>
    <li>
      <a href="../../articles/docs/basics.html">Basic Usage</a>
    </li>
    <li>
      <a href="../../articles/docs/visualize.html">Visualize Results</a>
    </li>
    <li>
      <a href="../../articles/docs/data.html">Downloading Genesets</a>
    </li>
    <li>
      <a href="../../articles/docs/hierarchy.html">Hierarchical Genesets</a>
    </li>
    <li>
      <a href="../../articles/docs/multihyp.html">Multiple Signatures</a>
    </li>
    <li>
      <a href="../../articles/docs/reporting.html">Generating Reports</a>
    </li>
    <li>
      <a href="../../articles/docs/shiny.html">Shiny Modules</a>
    </li>
    <li>
      <a href="../../articles/docs/fgsea.html">Fast Gene Set Enrichment Analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../../news/index.html">Change Log</a>
</li>
<li>
  <a href="https://github.com/montilab/hypeR">
    <span class="fas fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="fgsea_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Fast Gene Set Enrichment Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/montilab/hypeR/blob/master/vignettes/docs/fgsea.Rmd"><code>vignettes/docs/fgsea.Rmd</code></a></small>
      <div class="hidden name"><code>fgsea.Rmd</code></div>

    </div>

    
    
<div id="fast-gene-set-enrichment-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#fast-gene-set-enrichment-analysis" class="anchor"></a>Fast Gene Set Enrichment Analysis</h2>
<p>The primary focus of <code>hypeR</code> is on downstream enrichment analysis workflows. As long as enrichment results are formatted into a <code>hyp</code> object, they are compatible. To wrap third-party packages, we create modified version of the <code><a href="../../reference/hypeR.html">hypeR()</a></code> function that calls external packages when performing the enrichment analysis, and then coerces the results into a <code>hyp</code> or <code>multihyp</code>objects. Here we wrap <code>fgsea</code> - an R-package for <a href="https://www.biorxiv.org/content/10.1101/060012v3">fast preranked gene set enrichment analysis (GSEA)</a>.</p>
<blockquote>
<p><code>fgsea</code> is an R-package for fast preranked gene set enrichment analysis (GSEA). This package allows to quickly and accurately calculate arbitrarily low GSEA P-values for a collection of gene sets. P-value estimation is based on an adaptive multi-level split Monte-Carlo scheme.</p>
</blockquote>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ctlab/fgsea/">fgsea</a></span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Here we can take a differential expression analysis and rank genes by their t-statstic or some other measure of differential expression between two groups.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">limma</span><span class="op">)</span>

<span class="va">signature</span> <span class="op">&lt;-</span> <span class="va">limma</span> <span class="op">%&gt;%</span> <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">symbol</span>, <span class="va">t</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">deframe</span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">signature</span><span class="op">)</span></code></pre></div>
<pre><code>LMAN2L SHKBP1  SPHK2  AJUBA   TJP1  TMCC3 
  6.59   6.56   6.37   6.26   6.26   6.11 </code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">signature</span><span class="op">)</span></code></pre></div>
<pre><code>   PALD1 FRA10AC1      UNG     BET1  NKIRAS1   GPR146 
   -6.21    -6.28    -6.28    -6.52    -7.26    -8.48 </code></pre>
<p>We will also need some genesets…</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">genesets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/msigdb_gsets.html">msigdb_gsets</a></span><span class="op">(</span><span class="st">"Homo sapiens"</span>, <span class="st">"C2"</span>, <span class="st">"CP:KEGG"</span>, clean<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div id="wrapper-function" class="section level4">
<h4 class="hasAnchor">
<a href="#wrapper-function" class="anchor"></a>Wrapper function</h4>
<p><em>This is an experimental feature and not officially apart of the package.</em></p>
<p>The wrapper will take a signature and genesets as normally would be pass to <code>hyper()</code> and will instead feed them into <code><a href="https://rdrr.io/pkg/fgsea/man/fgseaMultilevel.html">fgsea::fgseaMultilevel()</a></code>. Please refer to their documentation for specific parameters. This will test your preranked signature in both directions (e.g. enrichment in high and low ranking genes). The wrapper then separates each direction into and up and down signature respectively and formats them within a <code>hyp</code> object. Thus the wrapper will return a <code>multihyp</code> object.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">.handle.genesets</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">genesets</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw">if</span> <span class="op">(</span><span class="fu">is</span><span class="op">(</span><span class="va">genesets</span>, <span class="st">"list"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">gsets.obj</span> <span class="op">&lt;-</span> <span class="va"><a href="../../reference/gsets.html">gsets</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">genesets</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
    <span class="op">}</span>
    <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="fu">is</span><span class="op">(</span><span class="va">genesets</span>, <span class="st">"gsets"</span><span class="op">)</span> <span class="op">|</span> <span class="fu">is</span><span class="op">(</span><span class="va">genesets</span>, <span class="st">"rgsets"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">gsets.obj</span> <span class="op">&lt;-</span> <span class="va">genesets</span>
    <span class="op">}</span> 
    <span class="kw">else</span> <span class="op">{</span>
        <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"Genesets must be gsets/rgsets object or named list of genesets"</span><span class="op">)</span>
    <span class="op">}</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">gsets.obj</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">fgsea.wrapper</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">signature</span>, <span class="va">genesets</span>, <span class="va">sample.size</span><span class="op">=</span><span class="fl">101</span>, <span class="va">min.size</span><span class="op">=</span><span class="fl">1</span>, <span class="va">max.size</span><span class="op">=</span><span class="cn">Inf</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span>
    <span class="co"># Save original arguments</span>
    <span class="va">args</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/environment.html">environment</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
    
    <span class="co"># Save gsets object</span>
    <span class="va">gsets.obj</span> <span class="op">&lt;-</span> <span class="fu">.handle.genesets</span><span class="op">(</span><span class="va">genesets</span><span class="op">)</span>
    <span class="va">args</span><span class="op">$</span><span class="va">genesets</span> <span class="op">&lt;-</span> <span class="va">gsets.obj</span>
    
    <span class="co"># Run fgsea</span>
    <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">fgsea</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/fgsea/man/fgseaMultilevel.html">fgseaMultilevel</a></span><span class="op">(</span>stats<span class="op">=</span><span class="va">signature</span>, 
                                      pathways<span class="op">=</span><span class="va">gsets.obj</span><span class="op">$</span><span class="va">genesets</span>, 
                                      sampleSize<span class="op">=</span><span class="va">sample.size</span>, 
                                      minSize<span class="op">=</span><span class="va">min.size</span>, 
                                      maxSize<span class="op">=</span><span class="va">max.size</span>, 
                                      <span class="va">...</span><span class="op">)</span>
    
    <span class="va">data</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op">%&gt;%</span>
        <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
        <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/rename.html">rename</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pathway"</span><span class="op">=</span><span class="st">"label"</span>, <span class="st">"padj"</span><span class="op">=</span><span class="st">"fdr"</span>, <span class="st">"log2err"</span><span class="op">=</span><span class="st">"lte"</span>, <span class="st">"size"</span><span class="op">=</span><span class="st">"overlap"</span>, <span class="st">"leadingEdge"</span><span class="op">=</span><span class="st">"le"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename_with</a></span><span class="op">(</span><span class="va">tolower</span><span class="op">)</span> <span class="op">%&gt;%</span>
        <span class="fu">mutate</span><span class="op">(</span>pval<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">signif</a></span><span class="op">(</span><span class="va">pval</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
        <span class="fu">mutate</span><span class="op">(</span>fdr<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">signif</a></span><span class="op">(</span><span class="va">fdr</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
        <span class="fu">mutate</span><span class="op">(</span>le<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">le</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">x</span>, collapse<span class="op">=</span><span class="st">','</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
        <span class="fu">mutate</span><span class="op">(</span>signature<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">signature</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
        <span class="fu">mutate</span><span class="op">(</span>geneset<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">label</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">gsets.obj</span><span class="op">$</span><span class="va">genesets</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"label"</span>, <span class="st">"pval"</span>, <span class="st">"fdr"</span>, <span class="st">"lte"</span>, <span class="st">"es"</span>, <span class="st">"nes"</span>, <span class="st">"signature"</span>, <span class="st">"geneset"</span>, <span class="st">"overlap"</span>, <span class="st">"le"</span><span class="op">)</span><span class="op">)</span>
    
    <span class="va">data.up</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span>
        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">es</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span>
        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">pval</span>, <span class="va">es</span><span class="op">)</span>

    <span class="va">data.dn</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span>
        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">es</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span>
        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">pval</span>, <span class="va">es</span><span class="op">)</span>    

    <span class="co"># Reproducibility information</span>
    <span class="va">info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>fgsea<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"v"</span>, <span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html">packageVersion</a></span><span class="op">(</span><span class="st">"fgsea"</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>,
                 signature<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">signature</span><span class="op">)</span>, 
                 genesets<span class="op">=</span><span class="va">args</span><span class="op">$</span><span class="va">genesets</span><span class="op">$</span><span class="fu">info</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
    
    <span class="va">info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">info</span>, <span class="va">args</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sample.size"</span>, <span class="st">"min.size"</span>, <span class="st">"max.size"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
    <span class="va">info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">info</span>, <span class="va">as.character</span><span class="op">)</span>
    
    <span class="co"># Wrap dataframe in hyp object</span>
    <span class="va">hyp.up</span> <span class="op">&lt;-</span> <span class="va"><a href="../../reference/hyp.html">hyp</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>data<span class="op">=</span><span class="va">data.up</span>, args<span class="op">=</span><span class="va">args</span>, info<span class="op">=</span><span class="va">info</span><span class="op">)</span>
    <span class="va">hyp.dn</span> <span class="op">&lt;-</span> <span class="va"><a href="../../reference/hyp.html">hyp</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>data<span class="op">=</span><span class="va">data.dn</span>, args<span class="op">=</span><span class="va">args</span>, info<span class="op">=</span><span class="va">info</span><span class="op">)</span>
    <span class="va">mhyp</span> <span class="op">&lt;-</span> <span class="va"><a href="../../reference/multihyp.html">multihyp</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"up"</span><span class="op">=</span><span class="va">hyp.up</span>, <span class="st">"dn"</span><span class="op">=</span><span class="va">hyp.dn</span><span class="op">)</span><span class="op">)</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">mhyp</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>You’ll likely see some warnings from <code>fgsea</code>…</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mhyp_obj</span> <span class="op">&lt;-</span> <span class="fu">fgsea.wrapper</span><span class="op">(</span><span class="va">signature</span>, <span class="va">genesets</span><span class="op">)</span></code></pre></div>
<pre><code>Warning in preparePathwaysAndStats(pathways, stats, minSize, maxSize, gseaParam, : There are ties in the preranked stats (70.45% of the list).
The order of those tied genes will be arbitrary, which may produce unexpected results.</code></pre>
<pre><code>Warning in fgsea::fgseaMultilevel(stats = signature, pathways =
gsets.obj$genesets, : For some pathways, in reality P-values are less than
1e-10. You can set the `eps` argument to zero for better estimation.</code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">mhyp_obj</span><span class="op">)</span></code></pre></div>
<pre><code>(multihyp) 
  (hyp) up
        132 x 10
  (hyp) dn
        54 x 10</code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The hyp object of the up signature</span>
<span class="va">hyp.up</span> <span class="op">&lt;-</span> <span class="va">mhyp_obj</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">up</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">hyp.up</span><span class="op">$</span><span class="va">info</span><span class="op">)</span></code></pre></div>
<pre><code>$fgsea
[1] "v1.15.0"

$signature
[1] "9682"

$genesets
[1] "C2.CP:KEGG v7.2.1"

$sample.size
[1] "101"

$min.size
[1] "1"

$max.size
[1] "Inf"</code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">hyp.up</span><span class="op">$</span><span class="va">data</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>                           label    pval     fdr       lte        es      nes
1                     Proteasome 8.8e-06 0.00055 0.5933255 0.6790805 2.161802
2           Steroid Biosynthesis 2.2e-05 0.00084 0.5756103 0.8209958 2.107131
3 Neurotrophin Signaling Pathway 2.3e-05 0.00084 0.5756103 0.4861587 1.966820
4                 Tight Junction 3.6e-05 0.00110 0.5573322 0.4919114 1.958631
5                    Endocytosis 3.0e-04 0.00690 0.4984931 0.4103587 1.729304
6             Endometrial Cancer 3.0e-04 0.00690 0.4984931 0.5940982 1.940034</code></pre>
<p>Now we can use it as we normally would…</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/hyp_dots.html">hyp_dots</a></span><span class="op">(</span><span class="va">mhyp_obj</span>, merge<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="fgsea_files/figure-html/unnamed-chunk-9-1.png" width="840" style="display: block; margin: auto;"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/anfederico">Anthony Federico</a>, <a href="https://github.com/tetomonti">Stefano Monti</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
