<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hierarchical Genesets • hypeR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><link href="../../extra.css" rel="stylesheet">
<meta property="og:title" content="Hierarchical Genesets">
<meta property="og:description" content="hypeR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">hypeR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.7.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Docs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/docs/installation.html">Installation</a>
    </li>
    <li>
      <a href="../../articles/docs/basics.html">Basic Usage</a>
    </li>
    <li>
      <a href="../../articles/docs/visualize.html">Visualize Results</a>
    </li>
    <li>
      <a href="../../articles/docs/data.html">Downloading Genesets</a>
    </li>
    <li>
      <a href="../../articles/docs/hierarchy.html">Hierarchical Genesets</a>
    </li>
    <li>
      <a href="../../articles/docs/multihyp.html">Multiple Signatures</a>
    </li>
    <li>
      <a href="../../articles/docs/reporting.html">Generating Reports</a>
    </li>
    <li>
      <a href="../../articles/docs/shiny.html">Shiny Modules</a>
    </li>
    <li>
      <a href="../../articles/docs/fgsea.html">Fast Gene Set Enrichment Analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../../news/index.html">Change Log</a>
</li>
<li>
  <a href="https://github.com/montilab/hypeR">
    <span class="fas fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="hierarchy_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="hierarchy_files/htmlwidgets-1.5.3/htmlwidgets.js"></script><link href="hierarchy_files/vis-4.20.1/vis.css" rel="stylesheet">
<script src="hierarchy_files/vis-4.20.1/vis.min.js"></script><script src="hierarchy_files/visNetwork-binding-2.0.9/visNetwork.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Hierarchical Genesets</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/montilab/hypeR/blob/master/vignettes/docs/hierarchy.Rmd"><code>vignettes/docs/hierarchy.Rmd</code></a></small>
      <div class="hidden name"><code>hierarchy.Rmd</code></div>

    </div>

    
    
<div id="relational-genesets" class="section level2">
<h2 class="hasAnchor">
<a href="#relational-genesets" class="anchor"></a>Relational Genesets</h2>
<p>When dealing with hundreds of genesets, it’s often useful to understand the relationships between them. This allows researchers to summarize many enriched pathways as more general biological processes. To do this, we rely on curated relationships defined between them. For example, <a href="https://reactome.org/">Reactome</a> conveniently defines their genesets in a <a href="https://reactome.org/PathwayBrowser/">hiearchy of pathways</a>. This data can be formatted into a relational genesets object called <code>rgsets</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">genesets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/hyperdb_rgsets.html">hyperdb_rgsets</a></span><span class="op">(</span><span class="st">"REACTOME"</span>, version<span class="op">=</span><span class="st">"70.0"</span><span class="op">)</span></code></pre></div>
<p>Relational genesets have three data atrributes including gsets, nodes, and edges. The <code>genesets</code> attribute includes the geneset information for the leaf nodes of the hiearchy, the <code>nodes</code> attribute describes all nodes in the hierarchy, including internal nodes, and the <code>edges</code> attribute describes the edges in the hiearchy.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">genesets</span><span class="op">)</span></code></pre></div>
<pre><code>REACTOME v70.0 

Genesets

2-LTR circle formation (13)
5-Phosphoribose 1-diphosphate biosynthesis (3)
A tetrasaccharide linker sequence is required for GAG synthesis (26)
ABC transporters in lipid homeostasis (18)
ABO blood group biosynthesis (3)
ADP signalling through P2Y purinoceptor 1 (25)

Nodes

                                                                        label
R-HSA-164843                                           2-LTR circle formation
R-HSA-73843                        5-Phosphoribose 1-diphosphate biosynthesis
R-HSA-1971475 A tetrasaccharide linker sequence is required for GAG synthesis
R-HSA-5619084                                       ABC transporter disorders
R-HSA-1369062                           ABC transporters in lipid homeostasis
R-HSA-382556                           ABC-family proteins mediated transport
                         id length
R-HSA-164843   R-HSA-164843     13
R-HSA-73843     R-HSA-73843      3
R-HSA-1971475 R-HSA-1971475     26
R-HSA-5619084 R-HSA-5619084     77
R-HSA-1369062 R-HSA-1369062     18
R-HSA-382556   R-HSA-382556     22

Edges

          from            to
1 R-HSA-109581  R-HSA-109606
2 R-HSA-109581  R-HSA-169911
3 R-HSA-109581 R-HSA-5357769
4 R-HSA-109581   R-HSA-75153
5 R-HSA-109582  R-HSA-140877
6 R-HSA-109582  R-HSA-202733</code></pre>
<p>Passing relational genesets works natively with <code><a href="../../reference/hypeR.html">hypeR()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">limma</span><span class="op">)</span>

<span class="va">signature</span> <span class="op">&lt;-</span> <span class="va">limma</span> <span class="op">%&gt;%</span> 
             <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
             <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html">use_series</a></span><span class="op">(</span><span class="va">symbol</span><span class="op">)</span>

<span class="va">hyp_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/hypeR.html">hypeR</a></span><span class="op">(</span><span class="va">signature</span>, <span class="va">genesets</span>, test<span class="op">=</span><span class="st">"kstest"</span>, fdr<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span></code></pre></div>
</div>
<div id="interactive-visualization" class="section level2">
<h2 class="hasAnchor">
<a href="#interactive-visualization" class="anchor"></a>Interactive Visualization</h2>
<p>One can visualize the top enriched genesets using <code><a href="../../reference/hyp_hmap.html">hyp_hmap()</a></code> which will return a hierarchy map. Each node represents a geneset, where the shade of the gold border indicates the normalized significance of enrichment. Hover over the leaf nodes to view the raw value. Double click internal nodes to cluster their first degree connections. Edges represent a directed relationship between genesets in the hiearchy. Note: This function only works when the <code>hyp</code> object was initialized with an <code>rgsets</code> object.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">vn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/hyp_hmap.html">hyp_hmap</a></span><span class="op">(</span><span class="va">hyp_obj</span>, top<span class="op">=</span><span class="fl">30</span><span class="op">)</span>
<span class="va">vn</span></code></pre></div>
<div id="htmlwidget-c667c190e7590cfb6e7f" style="width:840px;height:672px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-c667c190e7590cfb6e7f">{"x":{"nodes":{"label":["APC/C:Cdh1 mediated degradation of Cdc20 and other APC/C:Cdh1 targeted proteins in late mitosis/early G1","APC/C-mediated degradation of cell cycle proteins","Regulation of mitotic cell cycle","Cell Cycle, Mitotic","Cell Cycle","AUF1 (hnRNP D0) binds and destabilizes mRNA","Regulation of mRNA stability by proteins that bind AU-rich elements","Metabolism of RNA","Asymmetric localization of PCP proteins","PCP/CE pathway","Beta-catenin independent WNT signaling","Signaling by WNT","Signal Transduction","Autodegradation of the E3 ubiquitin ligase COP1","Stabilization of p53","p53-Dependent G1 DNA Damage Response","p53-Dependent G1/S DNA damage checkpoint","G1/S DNA Damage Checkpoints","Cell Cycle Checkpoints","Dectin-1 mediated noncanonical NF-kB signaling","CLEC7A (Dectin-1) signaling","C-type lectin receptors (CLRs)","Innate Immune System","Immune System","Degradation of AXIN","TCF dependent signaling in response to WNT","Degradation of DVL","Degradation of GLI1 by the proteasome","Hedgehog 'off' state","Signaling by Hedgehog","Degradation of GLI2 by the proteasome","FBXL7 down-regulates AURKA during mitotic entry and in early mitosis","G2/M Transition","Mitotic G2-G2/M phases","FCERI mediated NF-kB activation","Fc epsilon receptor (FCERI) signaling","GLI3 is processed to GLI3R by the proteasome","MAPK6/MAPK4 signaling","MAPK family signaling cascades","NIK-->noncanonical NF-kB signaling","TNFR2 non-canonical NF-kB pathway","Cytokine Signaling in Immune system","Negative regulation of NOTCH4 signaling","Signaling by NOTCH4","Signaling by NOTCH","Oxygen-dependent proline hydroxylation of Hypoxia-inducible Factor Alpha","Cellular response to hypoxia","Cellular responses to stress","Cellular responses to external stimuli","RHO GTPases Activate Formins","RHO GTPase Effectors","Signaling by Rho GTPases","Regulation of PLK1 Activity at G2/M Transition","Regulation of RAS by GAPs","RAF/MAP kinase cascade","MAPK1/MAPK3 signaling","FLT3 Signaling","Regulation of RUNX3 expression and activity","Transcriptional regulation by RUNX3","Generic Transcription Pathway","RNA Polymerase II Transcription","Gene expression (Transcription)","Regulation of activated PAK-2p34 by proteasome mediated degradation","Regulation of Apoptosis","Apoptosis","Programmed Cell Death","Regulation of ornithine decarboxylase (ODC)","Metabolism of polyamines","Metabolism of amino acids and derivatives","Metabolism","SCF-beta-TrCP mediated degradation of Emi1","Regulation of APC/C activators between G1/S and early anaphase","Separation of Sister Chromatids","Mitotic Anaphase","Mitotic Metaphase and Anaphase","M Phase","The role of GTSE1 in G2/M progression after G2 checkpoint","Ub-specific processing proteases","Deubiquitination","Post-translational protein modification","Metabolism of proteins","Ubiquitin Mediated Degradation of Phosphorylated Cdc25A","p53-Independent DNA Damage Response","p53-Independent G1/S DNA damage checkpoint","Ubiquitin-dependent degradation of Cyclin D","S Phase","Vif-mediated degradation of APOBEC3G","Host Interactions of HIV factors","HIV Infection","Infectious disease","Disease","Vpu mediated degradation of CD4"],"id":["R-HSA-174178","R-HSA-174143","R-HSA-453276","R-HSA-69278","R-HSA-1640170","R-HSA-450408","R-HSA-450531","R-HSA-8953854","R-HSA-4608870","R-HSA-4086400","R-HSA-3858494","R-HSA-195721","R-HSA-162582","R-HSA-349425","R-HSA-69541","R-HSA-69563","R-HSA-69580","R-HSA-69615","R-HSA-69620","R-HSA-5607761","R-HSA-5607764","R-HSA-5621481","R-HSA-168249","R-HSA-168256","R-HSA-4641257","R-HSA-201681","R-HSA-4641258","R-HSA-5610780","R-HSA-5610787","R-HSA-5358351","R-HSA-5610783","R-HSA-8854050","R-HSA-69275","R-HSA-453274","R-HSA-2871837","R-HSA-2454202","R-HSA-5610785","R-HSA-5687128","R-HSA-5683057","R-HSA-5676590","R-HSA-5668541","R-HSA-1280215","R-HSA-9604323","R-HSA-9013694","R-HSA-157118","R-HSA-1234176","R-HSA-1234174","R-HSA-2262752","R-HSA-8953897","R-HSA-5663220","R-HSA-195258","R-HSA-194315","R-HSA-2565942","R-HSA-5658442","R-HSA-5673001","R-HSA-5684996","R-HSA-9607240","R-HSA-8941858","R-HSA-8878159","R-HSA-212436","R-HSA-73857","R-HSA-74160","R-HSA-211733","R-HSA-169911","R-HSA-109581","R-HSA-5357801","R-HSA-350562","R-HSA-351202","R-HSA-71291","R-HSA-1430728","R-HSA-174113","R-HSA-176408","R-HSA-2467813","R-HSA-68882","R-HSA-2555396","R-HSA-68886","R-HSA-8852276","R-HSA-5689880","R-HSA-5688426","R-HSA-597592","R-HSA-392499","R-HSA-69601","R-HSA-69610","R-HSA-69613","R-HSA-75815","R-HSA-69242","R-HSA-180585","R-HSA-162909","R-HSA-162906","R-HSA-5663205","R-HSA-1643685","R-HSA-180534"],"length":[72,76,76,258,263,55,55,55,64,64,64,76,269,52,52,52,52,55,55,62,62,62,164,183,55,63,57,60,64,64,60,55,140,140,157,157,60,94,113,59,59,78,54,54,54,66,66,66,66,121,121,121,87,68,68,68,68,55,55,55,55,55,50,50,50,50,51,51,51,51,55,55,171,171,171,171,60,205,205,205,205,52,52,52,52,52,55,59,59,59,59,53],"size":[15,15,15,28.4931506849315,29.1780821917808,15,15,15,15,15,15,15,30,15,15,15,15,15,15,15,15,15,15.6164383561644,18.2191780821918,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16.5753424657534,16.5753424657534,16.5753424657534,16.5753424657534,15,21.2328767123288,21.2328767123288,21.2328767123288,21.2328767123288,15,15,15,15,15,15,15,15,15,15,15],"title":["FDR: 1.7e-05",null,null,null,null,"FDR: 1e-05",null,null,"FDR: 8.5e-05",null,null,null,null,"FDR: 1.7e-05",null,null,null,null,null,"FDR: 1.4e-05",null,null,null,null,"FDR: 4e-05",null,"FDR: 7.1e-05","FDR: 9e-05",null,null,"FDR: 9e-05","FDR: 7.1e-05",null,null,"FDR: 9.7e-05",null,"FDR: 9e-05","FDR: 1.1e-07",null,"FDR: 1e-05",null,null,"FDR: 1.4e-05",null,null,"FDR: 7.1e-05",null,null,null,"FDR: 9e-05",null,null,"FDR: 8.5e-05","FDR: 9e-05",null,null,null,"FDR: 9e-05",null,null,null,null,"FDR: 1.7e-05",null,null,null,"FDR: 9.9e-05",null,null,null,"FDR: 8.4e-06",null,"FDR: 8.4e-06",null,null,null,"FDR: 1e-05","FDR: 1.7e-05",null,null,null,"FDR: 8.5e-05",null,null,"FDR: 7.1e-05",null,"FDR: 7.6e-05",null,null,null,null,"FDR: 1e-05"],"color.background":["#C70039","#581845","#581845","#581845","#581845","#C70039","#581845","#581845","#C70039","#581845","#581845","#581845","#581845","#C70039","#581845","#581845","#581845","#581845","#581845","#C70039","#581845","#581845","#581845","#581845","#C70039","#581845","#C70039","#C70039","#581845","#581845","#C70039","#C70039","#581845","#581845","#C70039","#581845","#C70039","#C70039","#581845","#C70039","#581845","#581845","#C70039","#581845","#581845","#C70039","#581845","#581845","#581845","#C70039","#581845","#581845","#C70039","#C70039","#581845","#581845","#581845","#C70039","#581845","#581845","#581845","#581845","#C70039","#581845","#581845","#581845","#C70039","#581845","#581845","#581845","#C70039","#581845","#C70039","#581845","#581845","#581845","#C70039","#C70039","#581845","#581845","#581845","#C70039","#581845","#581845","#C70039","#581845","#C70039","#581845","#581845","#581845","#581845","#C70039"],"color.highlight":["#C70039E5","#581845E5","#581845E5","#581845E5","#581845E5","#C70039E5","#581845E5","#581845E5","#C70039E5","#581845E5","#581845E5","#581845E5","#581845E5","#C70039E5","#581845E5","#581845E5","#581845E5","#581845E5","#581845E5","#C70039E5","#581845E5","#581845E5","#581845E5","#581845E5","#C70039E5","#581845E5","#C70039E5","#C70039E5","#581845E5","#581845E5","#C70039E5","#C70039E5","#581845E5","#581845E5","#C70039E5","#581845E5","#C70039E5","#C70039E5","#581845E5","#C70039E5","#581845E5","#581845E5","#C70039E5","#581845E5","#581845E5","#C70039E5","#581845E5","#581845E5","#581845E5","#C70039E5","#581845E5","#581845E5","#C70039E5","#C70039E5","#581845E5","#581845E5","#581845E5","#C70039E5","#581845E5","#581845E5","#581845E5","#581845E5","#C70039E5","#581845E5","#581845E5","#581845E5","#C70039E5","#581845E5","#581845E5","#581845E5","#C70039E5","#581845E5","#C70039E5","#581845E5","#581845E5","#581845E5","#C70039E5","#C70039E5","#581845E5","#581845E5","#581845E5","#C70039E5","#581845E5","#581845E5","#C70039E5","#581845E5","#C70039E5","#581845E5","#581845E5","#581845E5","#581845E5","#C70039E5"],"color.border":["#FFC300D3","#581845","#581845","#581845","#581845","#FFC300E5","#581845","#581845","#FFC30024","#581845","#581845","#581845","#581845","#FFC300D3","#581845","#581845","#581845","#581845","#581845","#FFC300DB","#581845","#581845","#581845","#581845","#FFC30098","#581845","#FFC30048","#FFC30017","#581845","#581845","#FFC30017","#FFC30048","#581845","#581845","#FFC30005","#581845","#FFC30017","#FFC300FF","#581845","#FFC300E5","#581845","#581845","#FFC300DB","#581845","#581845","#FFC30048","#581845","#581845","#581845","#FFC30017","#581845","#581845","#FFC30024","#FFC30017","#581845","#581845","#581845","#FFC30017","#581845","#581845","#581845","#581845","#FFC300D3","#581845","#581845","#581845","#FFC30000","#581845","#581845","#581845","#FFC300E9","#581845","#FFC300E9","#581845","#581845","#581845","#FFC300E5","#FFC300D3","#581845","#581845","#581845","#FFC30024","#581845","#581845","#FFC30048","#581845","#FFC3003B","#581845","#581845","#581845","#581845","#FFC300E5"],"x":[-0.302049302730302,-0.415778976462802,-0.55843662898046,-0.629667044785802,-0.393057967845516,0.734870038956607,0.630890394723279,0.520547358169317,0.0788851499269265,0.00793684981679021,-0.0396641351818068,-0.109046829747341,-0.308617739924599,0.643316029888409,0.528774844657198,0.389700212824572,0.246012964999076,0.0958378874122403,-0.155996264806662,-0.222413626410607,-0.248605774738371,-0.138925534400892,-0.0155487452796554,-0.0398369092192441,0.219945772758833,0.0888359798341611,0.22675628163893,0.231953809483026,0.108575045734854,-0.0938812176642871,0.270953058237024,-0.387689524303487,-0.460292040692403,-0.547277819124142,0.105203173059618,0.104778028141998,0.135485409545525,-0.20329936742991,-0.315443448243422,0.242132353886124,0.102620030623749,-0.0604869642372411,-0.761659753243555,-0.635921360721665,-0.481754101453532,0.325411306432483,0.36017365606324,0.436565814367086,0.548336334633237,-0.909308693108877,-0.76788753799355,-0.564617337240975,-0.567774520523756,-0.523926853690366,-0.386850477395807,-0.382762775754152,-0.232554156106601,0.709797572561658,0.704217059557448,0.594644529387939,0.589900724734029,0.627583242180606,0.908742136661081,0.991506404162725,1,0.99696093839108,0.583249934125868,0.695509979027638,0.810665488483528,0.916464962044044,-0.128105429388004,-0.268656162983739,-1,-0.976470055552565,-0.934742760621485,-0.829520384024334,-0.324665724705095,0.802112994961359,0.832265240861226,0.902330793046114,0.946298469072671,0.540111210985393,0.412724587126776,0.266214520679715,-0.780961576759296,-0.723916052093571,-0.473332290067476,-0.597576325327042,-0.715624506660123,-0.811428126879817,-0.891720624660253,-0.563775023075836],"y":[-0.844134521328091,-0.882793757424357,-0.780563968371982,-0.621053945216965,-0.661374979259986,0.662318874030536,0.597271859592561,0.531749895690079,-0.886848336705733,-0.7306567680193,-0.49836768525644,-0.265863044111618,-0.053731857357541,-0.767712164727213,-0.827019435577256,-0.849415482549089,-0.800887723234317,-0.689838140113999,-0.67895511434228,1,0.89386454510211,0.831861910356595,0.77630561218479,0.647685960174789,-0.367365164363284,-0.286805457165819,-0.227296639313829,0.000912704095050065,0.0788336659412086,0.0036348824284429,0.1406658036985,-0.290266840772207,-0.401921022149392,-0.521226130388571,0.95453718104002,0.833474870195896,0.216843296944777,0.212587060460637,0.1335630916157,0.488936390174498,0.496903657642537,0.520596001591734,0.2526916276876,0.172830161323087,0.0623959283969973,0.9567568701134,0.846607247120873,0.758545758195415,0.795173830938426,0.104480572971617,0.0305156090824514,-0.0347983424445631,-0.292452862358189,0.479171137301703,0.445581767994385,0.295196815929872,0.504753738840556,0.0792256137594678,-0.0328796634762807,-0.0829450988555596,-0.205488991727732,-0.316666215880067,0.225730661004308,0.151569019174212,0.0345037442433829,-0.0795891837699554,0.297588046897554,0.353254540589313,0.419114693939306,0.470654225747978,-1,-0.970038766132734,-0.0957661844805715,-0.225660309272036,-0.381661001303961,-0.538662886595598,-0.456758057959759,-0.580734476463985,-0.47122757843526,-0.376036473745354,-0.275283554806969,-0.54826989089577,-0.581912096758289,-0.628214156044847,-0.337878876179675,-0.479400771685988,0.724610873068763,0.73688884432956,0.643830767802772,0.542390347168877,0.450643867575991,0.851371925951614]},"edges":{"from":["R-HSA-109581","R-HSA-1234174","R-HSA-1280215","R-HSA-1280215","R-HSA-1430728","R-HSA-157118","R-HSA-162582","R-HSA-162582","R-HSA-162582","R-HSA-162582","R-HSA-162582","R-HSA-162906","R-HSA-162909","R-HSA-162909","R-HSA-1640170","R-HSA-1640170","R-HSA-1643685","R-HSA-168249","R-HSA-168249","R-HSA-168256","R-HSA-168256","R-HSA-169911","R-HSA-174143","R-HSA-174143","R-HSA-176408","R-HSA-194315","R-HSA-195258","R-HSA-195721","R-HSA-195721","R-HSA-201681","R-HSA-201681","R-HSA-212436","R-HSA-2262752","R-HSA-2454202","R-HSA-2555396","R-HSA-351202","R-HSA-3858494","R-HSA-392499","R-HSA-4086400","R-HSA-450531","R-HSA-453274","R-HSA-453276","R-HSA-5357801","R-HSA-5358351","R-HSA-5607764","R-HSA-5610787","R-HSA-5610787","R-HSA-5610787","R-HSA-5621481","R-HSA-5663205","R-HSA-5668541","R-HSA-5673001","R-HSA-5683057","R-HSA-5683057","R-HSA-5684996","R-HSA-5688426","R-HSA-597592","R-HSA-68882","R-HSA-68886","R-HSA-69242","R-HSA-69275","R-HSA-69275","R-HSA-69275","R-HSA-69278","R-HSA-69278","R-HSA-69278","R-HSA-69278","R-HSA-69541","R-HSA-69563","R-HSA-69580","R-HSA-69610","R-HSA-69613","R-HSA-69615","R-HSA-69615","R-HSA-69620","R-HSA-71291","R-HSA-73857","R-HSA-74160","R-HSA-8878159","R-HSA-8953854","R-HSA-8953897","R-HSA-9013694","R-HSA-9607240"],"to":["R-HSA-169911","R-HSA-1234176","R-HSA-5668541","R-HSA-9607240","R-HSA-71291","R-HSA-9013694","R-HSA-157118","R-HSA-194315","R-HSA-195721","R-HSA-5358351","R-HSA-5683057","R-HSA-162909","R-HSA-180534","R-HSA-180585","R-HSA-69278","R-HSA-69620","R-HSA-5663205","R-HSA-2454202","R-HSA-5621481","R-HSA-1280215","R-HSA-168249","R-HSA-211733","R-HSA-174178","R-HSA-176408","R-HSA-174113","R-HSA-195258","R-HSA-5663220","R-HSA-201681","R-HSA-3858494","R-HSA-4641257","R-HSA-4641258","R-HSA-8878159","R-HSA-1234174","R-HSA-2871837","R-HSA-68882","R-HSA-350562","R-HSA-4086400","R-HSA-597592","R-HSA-4608870","R-HSA-450408","R-HSA-69275","R-HSA-174143","R-HSA-109581","R-HSA-5610787","R-HSA-5607761","R-HSA-5610780","R-HSA-5610783","R-HSA-5610785","R-HSA-5607764","R-HSA-162906","R-HSA-5676590","R-HSA-5658442","R-HSA-5684996","R-HSA-5687128","R-HSA-5673001","R-HSA-5689880","R-HSA-5688426","R-HSA-2467813","R-HSA-2555396","R-HSA-75815","R-HSA-2565942","R-HSA-8852276","R-HSA-8854050","R-HSA-453274","R-HSA-453276","R-HSA-68886","R-HSA-69242","R-HSA-349425","R-HSA-69541","R-HSA-69563","R-HSA-69601","R-HSA-69610","R-HSA-69580","R-HSA-69613","R-HSA-69615","R-HSA-351202","R-HSA-212436","R-HSA-73857","R-HSA-8941858","R-HSA-450531","R-HSA-2262752","R-HSA-9604323","R-HSA-5673001"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","borderWidth":3,"borderWidthSelected":0,"physics":false},"manipulation":{"enabled":false},"edges":{"selectionWidth":0,"arrows":"to","smooth":false},"physics":{"stabilization":false},"interaction":{"multiselect":true,"tooltipDelay":300}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":{"text":"","style":"font-family:Helvetica"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":true,"fit":false,"resetHighlight":true,"clusterOptions":{"color":"rgba(199,0,57,1.0)"},"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script><p>Save to an html file.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>vn &lt;-<span class="st"> </span>visNetwork<span class="op">::</span><span class="kw">visOptions</span>(vn, <span class="dt">width=</span><span class="st">"1280px"</span>, <span class="dt">height=</span><span class="st">"720px"</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a>visNetwork<span class="op">::</span><span class="kw">visSave</span>(vn, <span class="st">"hyp_obj.html”)</span></span></code></pre></div>
</div>
<div id="static-visualization" class="section level2">
<h2 class="hasAnchor">
<a href="#static-visualization" class="anchor"></a>Static Visualization</h2>
<p>One of the downsides of the above interactive object is it’s difficult to render high quality figures in specific formats. You could take a screenshot after interacting with the figure, however that might not be high enough resolution for a publication. To help with this, you can alternatively return an <code>igraph</code> object pre-formatted with enrichment data.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ig</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/hyp_hmap.html">hyp_hmap</a></span><span class="op">(</span><span class="va">hyp_obj</span>, top<span class="op">=</span><span class="fl">30</span>, graph<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ig</span><span class="op">)</span></code></pre></div>
<pre><code>IGRAPH aa0593f DN-B 92 83 -- 
+ attr: name (v/c), fdr (v/n), size (v/n), color (v/c), frame.color
| (v/c), label (v/c), type (v/c), label.family (v/c), label.color
| (v/c), label.font (v/n), label.cex (v/n), label.dist (v/n), width
| (e/n), color (e/c), arrow.size (e/n)
+ edges from aa0593f (vertex names):
 [1] R-HSA-109581 -&gt;R-HSA-169911  R-HSA-1234174-&gt;R-HSA-1234176
 [3] R-HSA-1280215-&gt;R-HSA-5668541 R-HSA-1280215-&gt;R-HSA-9607240
 [5] R-HSA-1430728-&gt;R-HSA-71291   R-HSA-157118 -&gt;R-HSA-9013694
 [7] R-HSA-162582 -&gt;R-HSA-157118  R-HSA-162582 -&gt;R-HSA-194315 
 [9] R-HSA-162582 -&gt;R-HSA-195721  R-HSA-162582 -&gt;R-HSA-5358351
+ ... omitted several edges</code></pre>
<p>Colors, weights, and normalized sizing properties from the interactive visualization are copied over to the vertex properties of the <code>igraph</code> object.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html">as_data_frame</a></span><span class="op">(</span><span class="va">ig</span>, what<span class="op">=</span><span class="st">"vertices"</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"name"</span>, <span class="st">"type"</span>, <span class="st">"fdr"</span>, <span class="st">"size"</span>, <span class="st">"color"</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<pre><code>                       name     type     fdr     size   color
R-HSA-174178   R-HSA-174178     leaf 1.7e-05 15.00000 #C70039
R-HSA-174143   R-HSA-174143 internal      NA 15.00000 #581845
R-HSA-453276   R-HSA-453276 internal      NA 15.00000 #581845
R-HSA-69278     R-HSA-69278 internal      NA 28.49315 #581845
R-HSA-1640170 R-HSA-1640170 internal      NA 29.17808 #581845
R-HSA-450408   R-HSA-450408     leaf 1.0e-05 15.00000 #C70039</code></pre>
<p>Because genesets labels are typically long, it’s static visualizations are difficult. You’ll need to make custom adjustments depending on your needs.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Consistent layout</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>

<span class="co"># Overriding existing edge/vertex properties</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">ig</span>,
     vertex.label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu">V</span><span class="op">(</span><span class="va">ig</span><span class="op">)</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"leaf"</span>, <span class="fu">V</span><span class="op">(</span><span class="va">ig</span><span class="op">)</span><span class="op">$</span><span class="va">label</span>, <span class="st">""</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">32</span><span class="op">)</span>, 
     vertex.size<span class="op">=</span><span class="fl">5</span><span class="op">)</span></code></pre></div>
<p><img src="hierarchy_files/figure-html/unnamed-chunk-9-1.png" width="1152" style="display: block; margin: auto;"></p>
<div id="high-quality-rendering" class="section level4">
<h4 class="hasAnchor">
<a href="#high-quality-rendering" class="anchor"></a>High quality rendering</h4>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/png.html">tiff</a></span><span class="op">(</span><span class="st">"hyp_obj.tiff"</span>, units<span class="op">=</span><span class="st">"in"</span>, width<span class="op">=</span><span class="fl">8</span>, height<span class="op">=</span><span class="fl">8</span>, res<span class="op">=</span><span class="fl">300</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">ig</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="raw-graph-objects" class="section level2">
<h2 class="hasAnchor">
<a href="#raw-graph-objects" class="anchor"></a>Raw Graph Objects</h2>
<p>You can also directly copy enrichment data from a <code>hyp</code> object to an <code>igraph</code> object.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ig</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/hyp_to_graph.html">hyp_to_graph</a></span><span class="op">(</span><span class="va">hyp_obj</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ig</span><span class="op">)</span></code></pre></div>
<pre><code>IGRAPH c6922c7 DN-- 2255 2264 -- 
+ attr: name (v/c), label (v/c), pval (v/n), fdr (v/n), signature
| (v/n), geneset (v/n), overlap (v/n), score (v/n)
+ edges from c6922c7 (vertex names):
 [1] R-HSA-109581-&gt;R-HSA-109606  R-HSA-109581-&gt;R-HSA-169911 
 [3] R-HSA-109581-&gt;R-HSA-5357769 R-HSA-109581-&gt;R-HSA-75153  
 [5] R-HSA-109582-&gt;R-HSA-140877  R-HSA-109582-&gt;R-HSA-202733 
 [7] R-HSA-109582-&gt;R-HSA-418346  R-HSA-109582-&gt;R-HSA-75205  
 [9] R-HSA-109582-&gt;R-HSA-75892   R-HSA-109582-&gt;R-HSA-76002  
[11] R-HSA-109582-&gt;R-HSA-983231  R-HSA-109606-&gt;R-HSA-111452 
[13] R-HSA-109606-&gt;R-HSA-111453  R-HSA-109606-&gt;R-HSA-111471 
+ ... omitted several edges</code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df.v</span> <span class="op">&lt;-</span> <span class="va">ig</span> <span class="op">%&gt;%</span>
        <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html">as_data_frame</a></span><span class="op">(</span>what<span class="op">=</span><span class="st">"vertices"</span><span class="op">)</span> <span class="op">%&gt;%</span>
        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">fdr</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df.v</span><span class="op">)</span></code></pre></div>
<pre><code>                       name
R-HSA-5687128 R-HSA-5687128
R-HSA-174113   R-HSA-174113
R-HSA-2467813 R-HSA-2467813
R-HSA-450408   R-HSA-450408
R-HSA-5676590 R-HSA-5676590
R-HSA-8852276 R-HSA-8852276
                                                                  label    pval
R-HSA-5687128                                     MAPK6/MAPK4 signaling 6.8e-11
R-HSA-174113                 SCF-beta-TrCP mediated degradation of Emi1 1.6e-08
R-HSA-2467813                           Separation of Sister Chromatids 1.3e-08
R-HSA-450408                AUF1 (hnRNP D0) binds and destabilizes mRNA 4.6e-08
R-HSA-5676590                        NIK--&gt;noncanonical NF-kB signaling 3.8e-08
R-HSA-8852276 The role of GTSE1 in G2/M progression after G2 checkpoint 4.1e-08
                  fdr signature geneset overlap score
R-HSA-5687128 1.1e-07      9682      94      62  0.44
R-HSA-174113  8.4e-06      9682      55      35  0.51
R-HSA-2467813 8.4e-06      9682     171     112  0.29
R-HSA-450408  1.0e-05      9682      55      32  0.51
R-HSA-5676590 1.0e-05      9682      59      38  0.48
R-HSA-8852276 1.0e-05      9682      60      36  0.49</code></pre>
<p>Notice that internal nodes that don’t have associated genesets (just generalized labels) will not have enrichment data associated with them.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">df.v</span><span class="op">)</span></code></pre></div>
<pre><code>                       name
R-HSA-6785470 R-HSA-6785470
R-HSA-6784531 R-HSA-6784531
R-HSA-199992   R-HSA-199992
R-HSA-4839744 R-HSA-4839744
R-HSA-192814   R-HSA-192814
R-HSA-192905   R-HSA-192905
                                                                  label pval
R-HSA-6785470                      tRNA processing in the mitochondrion   NA
R-HSA-6784531                            tRNA processing in the nucleus   NA
R-HSA-199992                        trans-Golgi Network Vesicle Budding   NA
R-HSA-4839744 truncated APC mutants destabilize the destruction complex   NA
R-HSA-192814                                             vRNA Synthesis   NA
R-HSA-192905                                              vRNP Assembly   NA
              fdr signature geneset overlap score
R-HSA-6785470  NA        NA      NA      NA    NA
R-HSA-6784531  NA        NA      NA      NA    NA
R-HSA-199992   NA        NA      NA      NA    NA
R-HSA-4839744  NA        NA      NA      NA    NA
R-HSA-192814   NA        NA      NA      NA    NA
R-HSA-192905   NA        NA      NA      NA    NA</code></pre>
</div>
<div id="data-driven-hierarchies" class="section level2">
<h2 class="hasAnchor">
<a href="#data-driven-hierarchies" class="anchor"></a>Data Driven Hierarchies</h2>
<p><em>This is an experimental feature and not officially apart of the package.</em></p>
<p>Genesets are often redundant, hard to parse, and lack relational structure. Thus it can be useful to infer which genesets are similar before analyzing enrichment results to help group multiple enriched genesets or pathways into more generalizable processes. Here we show a data-driven method using <a href="https://academic.oup.com/bioinformatics/article/33/11/1604/2959905">Hierarchical Set</a> for turning flat genesets into <code>rgsets</code> objects.</p>
<div id="explanation-from-hierarchical-sets" class="section level4">
<h4 class="hasAnchor">
<a href="#explanation-from-hierarchical-sets" class="anchor"></a>Explanation from hierarchical sets</h4>
<blockquote>
<p>The clustering, in contrast to more traditional approaches to hierarchical clustering, does not rely on a derived distance measure between the sets, but instead works directly with the set data itself using set algebra. This has two results: First, it is much easier to reason about the result in a set context, and second, you are not forced to provide a distance if none exists (sets are completely independent). The clustering is based on a generalization of Jaccard similarity, called Set Family Homogeneity, that, in its simplest form, is defined as the size of the intersection of the sets in the family divided by the size of the union of the sets in the family. The clustering progresses by iteratively merging the set families that shows the highest set family homogeneity and is terminated once all remaining set family pairs have a homogeneity of 0. Note that this means that the clustering does not necessarily end with the all sets in one overall cluster, but possibly split into several hierarchies - this is intentional.</p>
</blockquote>
</div>
<div id="flat-genests" class="section level4">
<h4 class="hasAnchor">
<a href="#flat-genests" class="anchor"></a>Flat genests</h4>
<p>What if we want to use the KEGG genesets from MSigDB - but we want to organize them into a hierarchy?</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gsets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/msigdb_gsets.html">msigdb_gsets</a></span><span class="op">(</span><span class="st">"Homo sapiens"</span>, <span class="st">"C2"</span>, <span class="st">"CP:KEGG"</span>, clean<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="va">genesets</span> <span class="op">&lt;-</span> <span class="va">gsets</span><span class="op">$</span><span class="va">genesets</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">genesets</span><span class="op">)</span></code></pre></div>
<pre><code>[1] 186</code></pre>
</div>
<div id="clustering" class="section level4">
<h4 class="hasAnchor">
<a href="#clustering" class="anchor"></a>Clustering</h4>
<p>We need some additional packages to help with this…</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">hierarchicalSets</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://trinker.github.com/qdapTools/">qdapTools</a></span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mat</span> <span class="op">&lt;-</span> <span class="va">genesets</span> <span class="op">%&gt;%</span>
    <span class="fu">qdapTools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qdapTools/man/mtabulate.html">mtabulate</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">hierarchicalSets</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/hierarchicalSets/man/format_sets.html">format_sets</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">hierarchy</span> <span class="op">&lt;-</span> <span class="fu">hierarchicalSets</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/hierarchicalSets/man/create_hierarchy.html">create_hierarchy</a></span><span class="op">(</span><span class="va">mat</span>, intersectLimit<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">hierarchy</span><span class="op">)</span></code></pre></div>
<pre><code>A HierarchicalSet object

                 Universe size: 5245
                Number of sets: 186
Number of independent clusters: 50</code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">hierarchy</span>, type<span class="op">=</span><span class="st">'intersectStack'</span>, showHierarchy<span class="op">=</span><span class="cn">TRUE</span>, label<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="hierarchy_files/figure-html/unnamed-chunk-16-1.png" width="1152" style="display: block; margin: auto;"></p>
<p>There is clearly a lot of overlap between these genesets…</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">hierarchy</span>, type<span class="op">=</span><span class="st">'outlyingElements'</span>, quantiles<span class="op">=</span><span class="fl">0.75</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, label<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="hierarchy_files/figure-html/unnamed-chunk-17-1.png" width="840" style="display: block; margin: auto;"></p>
</div>
<div id="extracting-the-hierarchy" class="section level4">
<h4 class="hasAnchor">
<a href="#extracting-the-hierarchy" class="anchor"></a>Extracting the hierarchy</h4>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://talgalili.github.io/dendextend/">dendextend</a></span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://stringi.gagolewski.com/">stringi</a></span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>A helper function for recursively reading and extracting trees from the clustering structure.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">find.trees</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">subtrees</span> <span class="op">&lt;-</span> <span class="fu">dendextend</span><span class="fu">::</span><span class="fu"><a href="http://talgalili.github.io/dendextend/reference/partition_leaves.html">partition_leaves</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>
    <span class="va">leaves</span> <span class="op">&lt;-</span> <span class="va">subtrees</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
    <span class="va">find.paths</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">leaf</span><span class="op">)</span> <span class="op">{</span>
        <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">subtrees</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">leaf</span> <span class="op">%in%</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>
    <span class="va">paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">leaves</span>, <span class="va">find.paths</span><span class="op">)</span>
    <span class="va">edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>from<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span>, to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span>
        <span class="kw">for</span> <span class="op">(</span><span class="va">path</span> <span class="kw">in</span> <span class="va">paths</span><span class="op">)</span> <span class="op">{</span>
            <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
                <span class="va">edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">edges</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>from<span class="op">=</span><span class="va">path</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, to<span class="op">=</span><span class="va">path</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
            <span class="op">}</span>
        <span class="op">}</span>
        <span class="va">edges</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">edges</span><span class="op">)</span>
        <span class="va">edges</span><span class="op">$</span><span class="va">from</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"N"</span>, <span class="va">edges</span><span class="op">$</span><span class="va">from</span><span class="op">)</span>
        <span class="va">edges</span><span class="op">$</span><span class="va">to</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"N"</span>, <span class="va">edges</span><span class="op">$</span><span class="va">to</span><span class="op">)</span>
    <span class="op">}</span>
    <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">subtrees</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"N"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">subtrees</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
    <span class="va">nodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">subtrees</span><span class="op">)</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">nodes</span><span class="op">$</span><span class="va">id</span>
    <span class="va">nodes</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="st">""</span>
    <span class="va">leaves</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">subtrees</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>
    <span class="va">nodes</span><span class="op">$</span><span class="va">label</span><span class="op">[</span><span class="va">leaves</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">subtrees</span><span class="op">[</span><span class="va">leaves</span><span class="op">]</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
    <span class="va">nodes</span><span class="op">$</span><span class="va">id</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
    
    <span class="co"># Internal nodes will not have labels, so we can generate unique hash identifiers</span>
    <span class="va">ids</span> <span class="op">&lt;-</span> <span class="fu">stringi</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/stringi/man/stri_rand_strings.html">stri_rand_strings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">)</span>, <span class="fl">32</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">ids</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">ids</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">)</span><span class="op">]</span>
    <span class="va">edges</span><span class="op">$</span><span class="va">from</span> <span class="op">&lt;-</span> <span class="va">ids</span><span class="op">[</span><span class="va">edges</span><span class="op">$</span><span class="va">from</span><span class="op">]</span>
    <span class="va">edges</span><span class="op">$</span><span class="va">to</span> <span class="op">&lt;-</span> <span class="va">ids</span><span class="op">[</span><span class="va">edges</span><span class="op">$</span><span class="va">to</span><span class="op">]</span>
    
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"edges"</span><span class="op">=</span><span class="va">edges</span>, <span class="st">"nodes"</span><span class="op">=</span><span class="va">nodes</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">trees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">hierarchy</span><span class="op">$</span><span class="va">clusters</span>, <span class="va">find.trees</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">trees</span><span class="op">)</span></code></pre></div>
<pre><code>[1] 50</code></pre>
<p>Now we can merge the independent trees into a single graph…</p>
</div>
<div id="nodes" class="section level4">
<h4 class="hasAnchor">
<a href="#nodes" class="anchor"></a>Nodes</h4>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nodes.all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">trees</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">nodes</span><span class="op">)</span>
<span class="va">nodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">nodes.all</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">)</span></code></pre></div>
<pre><code>                                                                                      label
jUUzOhno3bloMT8QXE5KGQaVvwBRt2K1                                           Abc Transporters
A296wAg1OnK4UfspjYApkvaIEdDMNEcG                                                           
ZQmYXCWN7gey2YHYPkyZ2Z2cO5VguNoY Epithelial Cell Signaling In Helicobacter Pylori Infection
Amkon0r1hXwUMAFd5vB1b2kM3iaTqHnO                                  Vibrio Cholerae Infection
cPj5PgqXVbw9o6m48RbiIvWasBMNI7oa                                                           
tdqY8vlhyDwxanxeOX0rarojDMsS1Hb9                                                           </code></pre>
</div>
<div id="edges" class="section level4">
<h4 class="hasAnchor">
<a href="#edges" class="anchor"></a>Edges</h4>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">edges.all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">trees</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">edges</span><span class="op">)</span>
<span class="va">edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">edges.all</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">edges</span><span class="op">)</span></code></pre></div>
<pre><code>                              from                               to
1 A296wAg1OnK4UfspjYApkvaIEdDMNEcG ZQmYXCWN7gey2YHYPkyZ2Z2cO5VguNoY
2 A296wAg1OnK4UfspjYApkvaIEdDMNEcG Amkon0r1hXwUMAFd5vB1b2kM3iaTqHnO
3 cPj5PgqXVbw9o6m48RbiIvWasBMNI7oa tdqY8vlhyDwxanxeOX0rarojDMsS1Hb9
4 tdqY8vlhyDwxanxeOX0rarojDMsS1Hb9 yNMKl6Su7kkPooY2l1WE6SjTGZLYVE4b
5 tdqY8vlhyDwxanxeOX0rarojDMsS1Hb9 zdr2p3XuCE4CbFHRbC78che7tIfiZYNd
6 cPj5PgqXVbw9o6m48RbiIvWasBMNI7oa KsTjbfPIC7orJKNRMF89pm0wCGtXmiDI</code></pre>
<p>Create the relational genesets object…</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rgsets_obj</span> <span class="op">&lt;-</span> <span class="va"><a href="../../reference/rgsets.html">rgsets</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">genesets</span>, <span class="va">nodes</span>, <span class="va">edges</span>, name<span class="op">=</span><span class="st">"MSIGDB_KEGG"</span>, version<span class="op">=</span><span class="fu"><a href="../../reference/msigdb_version.html">msigdb_version</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">rgsets_obj</span></code></pre></div>
<pre><code>MSIGDB_KEGG v7.2.1 

Genesets

Abc Transporters (44)
Acute Myeloid Leukemia (57)
Adherens Junction (73)
Adipocytokine Signaling Pathway (67)
Alanine Aspartate And Glutamate Metabolism (32)
Aldosterone Regulated Sodium Reabsorption (42)

Nodes

                                                                                      label
jUUzOhno3bloMT8QXE5KGQaVvwBRt2K1                                           Abc Transporters
A296wAg1OnK4UfspjYApkvaIEdDMNEcG                                                           
ZQmYXCWN7gey2YHYPkyZ2Z2cO5VguNoY Epithelial Cell Signaling In Helicobacter Pylori Infection
Amkon0r1hXwUMAFd5vB1b2kM3iaTqHnO                                  Vibrio Cholerae Infection
cPj5PgqXVbw9o6m48RbiIvWasBMNI7oa                                                           
tdqY8vlhyDwxanxeOX0rarojDMsS1Hb9                                                           
                                                               id length
jUUzOhno3bloMT8QXE5KGQaVvwBRt2K1 jUUzOhno3bloMT8QXE5KGQaVvwBRt2K1     44
A296wAg1OnK4UfspjYApkvaIEdDMNEcG A296wAg1OnK4UfspjYApkvaIEdDMNEcG     95
ZQmYXCWN7gey2YHYPkyZ2Z2cO5VguNoY ZQmYXCWN7gey2YHYPkyZ2Z2cO5VguNoY     68
Amkon0r1hXwUMAFd5vB1b2kM3iaTqHnO Amkon0r1hXwUMAFd5vB1b2kM3iaTqHnO     54
cPj5PgqXVbw9o6m48RbiIvWasBMNI7oa cPj5PgqXVbw9o6m48RbiIvWasBMNI7oa    315
tdqY8vlhyDwxanxeOX0rarojDMsS1Hb9 tdqY8vlhyDwxanxeOX0rarojDMsS1Hb9    248

Edges

                              from                               to
1 A296wAg1OnK4UfspjYApkvaIEdDMNEcG ZQmYXCWN7gey2YHYPkyZ2Z2cO5VguNoY
2 A296wAg1OnK4UfspjYApkvaIEdDMNEcG Amkon0r1hXwUMAFd5vB1b2kM3iaTqHnO
3 cPj5PgqXVbw9o6m48RbiIvWasBMNI7oa tdqY8vlhyDwxanxeOX0rarojDMsS1Hb9
4 tdqY8vlhyDwxanxeOX0rarojDMsS1Hb9 yNMKl6Su7kkPooY2l1WE6SjTGZLYVE4b
5 tdqY8vlhyDwxanxeOX0rarojDMsS1Hb9 zdr2p3XuCE4CbFHRbC78che7tIfiZYNd
6 cPj5PgqXVbw9o6m48RbiIvWasBMNI7oa KsTjbfPIC7orJKNRMF89pm0wCGtXmiDI</code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hyp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/hypeR.html">hypeR</a></span><span class="op">(</span><span class="va">signature</span>, <span class="va">rgsets_obj</span>, test<span class="op">=</span><span class="st">"kstest"</span><span class="op">)</span>
<span class="fu"><a href="../../reference/hyp_dots.html">hyp_dots</a></span><span class="op">(</span><span class="va">hyp</span>, fdr<span class="op">=</span><span class="fl">0.1</span>, top<span class="op">=</span><span class="fl">25</span><span class="op">)</span></code></pre></div>
<p><img src="hierarchy_files/figure-html/unnamed-chunk-24-1.png" width="840" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/hyp_hmap.html">hyp_hmap</a></span><span class="op">(</span><span class="va">hyp</span>, fdr<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-3ab171ee66056ff30e59" style="width:840px;height:432.632880098888px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-3ab171ee66056ff30e59">{"x":{"nodes":{"label":["Cell Cycle","","Oocyte Meiosis","","","Progesterone Mediated Oocyte Maturation","Ubiquitin Mediated Proteolysis","Vegf Signaling Pathway","","","","Mapk Signaling Pathway","Terpenoid Backbone Biosynthesis","","Steroid Biosynthesis","","Pathogenic Escherichia Coli Infection","","","Tight Junction","","Proteasome","","Endocytosis","","Bladder Cancer","","","","Thyroid Cancer","Leishmania Infection","","Colorectal Cancer","","","","","","","","Endometrial Cancer","Acute Myeloid Leukemia","Pancreatic Cancer","","","","Non Small Cell Lung Cancer","","Insulin Signaling Pathway","","","","Neurotrophin Signaling Pathway","Renal Cell Carcinoma","","Fc Gamma R Mediated Phagocytosis","",""],"id":["oMiYOzY9kdBn6GzLI2evGUSVHO0zItBM","kWNpvd7y3bONibZiRJ3Z1eVaX7cENUpe","HleQ3SpvVpSpCtiRKpKAPven5UjMVMWy","xNSRkkBnzXbe7Hp2jFn0guiCc1d8O07Q","ECcBnfUZINxb5IQxVgY5ftcUh4erxOlb","cjV13YCAWXDXqETXx5fufzE9XerURZco","T9oWuzef31zL1S2bA1jv9p0eLas6Xtbq","NfPUlO94ofketuKoWQyPX1jD8QYtbBof","AJQX134ERGVzuOCpR3ik6RefJ6CFGqXz","uK9aPiKakxPueWrMsGoq7UOUZYENgYsi","nEW35ZynkoJI0dfrDnaf4Tn8gH8i8CHK","mK97FQcG3X13Ax1KsEeEpon07Nej3Zfl","G9kLwJ9k8rBGuLXL4szfI7Egylr8ahQv","ZU60OCCULzQyvRSNFVX7Pu1T1WX2kTcO","IxP25qupyWAio4UjZ9LFTd9dTTHZ3TIy","HoTpAvj2HXengsgKqLRUDYL3yDcRJczK","DdQwSqSHyjJINXnY0Ti4pWQtvbnpCp4t","c7CKwXN6rmi5oMoUsRdFEJo2WK1hJFAv","dVTNb6nZ2HtfqlmlgMHglzBzGRCoxMz4","IRVg8VZEVXtQ9I0LZRQ5h9JlcDzWkc6l","GkuwfcVVoZW9MaMMOF073kQp44J6NDNG","OKPKrcJgI2KlfIJxraVQ5rPRyOwc8eBc","wAwFualtTsJ9DOs20p4DzfKCDhaGJHaP","rZM9l9ITcgzuE1mEPYo07448PNBJJmRC","87MgwCKmUiO0I08QeBYeClOP8vqlDpwU","V0i3biAH0il1lj3f5sCiOPcLLOHGSCVt","BFXf5iOFgbwAbQ0U7cVG547yBuybs6FT","UYYS700PUZ5qJPYmOzQmCyPrFXtIfY9Q","1cPas2LcSlg4ZChW4VB3t29YYBBEsCUU","PePmr8EedPU1V2Ew1MzrB9Fn4a7MTbbd","mUVkwWimBqv7JKVI9Ts6Wa1QFxYoV2aB","RqhatgfE5sPfybQXQtcuD9Sjpx8Jee87","N21IcwKHFJHEbDRphbUaTpIZEht1dky9","zROgo4Gjym5PHmAlOgKpffvjazKlnLaN","l4Qx052d5qIp69NWgGCAg2Zta1uE0lwj","ZFeaANW7ewsY3vvvcT8DBYW5p87eivN2","ISnXDujbx7Fk5o372466DQMH4qhAJKhf","BMWKlJbGTMo91CUjpg1ycfLcNybpiO9j","zM4Pv31DiJlYPuIxnOdjNipYRlQYq3e2","uAknv6qkURkyOsgqa8l8r6CRN4YMcJ6Y","hTJJWbkBUd1bZ8yEAk4tfm2Dvi4y3xf0","RES3uxrDjLngNfxXeoqrdK8t5TukPiq8","boCgXG6kRL0RNYayWJbDLvggkOAeMqdH","szmWkf8tF6G52Mz0L8gWdFPL9tzXsefR","NNzpttgK49ZxsOQmDoRvAzQxPhRu9O0P","8Os9GREy9NbffS2EXu0ncXQlBflbIJBh","jvHV2urs431zi7KnHAvhdeeMBYIEF3FO","FZgbOfv9lxAYZsMHByRYwJQphKXOJCiE","ufUKBUB59W8tQdKtGPqUXrYjZtyUs32u","cTsWnRLy1dKQ4ftQ2m2xI186Rm2T2E6P","DiBv7WAkJNzHzfw9hmKnFZLSKkkB9I9P","lpk736Awm0y5fLvoOGh1AkuUDLYeuEyQ","VS5TWCQ4ErKDpAyCHWbuRMvbe8Wh4K5y","f1YAWCMH1jQ8Ry82Ym7MNalkw38VHrmX","s8UoPlXRLhSUNOesmaMbZ9H7xeIKj9Kn","UjSytHEeTfRnv7Sv7rRFuyoDjMVTSvGA","WV4ICQu4FoIQkhHlmgMV7o483FNwMa62","JjpQS4eotWsHWs3ur66pyTGny9CfDMB2"],"length":[125,125,113,147,262,85,135,76,76,293,293,267,15,15,17,17,56,56,178,132,132,46,46,181,181,42,59,59,129,29,72,72,62,80,106,106,143,143,338,403,52,57,70,70,91,91,54,54,137,216,252,252,126,70,70,96,96,96],"size":[15,15,15,15,19.0979381443299,15,15,15,15,21.4948453608247,21.4948453608247,19.4845360824742,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,24.9742268041237,30,15,15,15,15,15,15,15,15,15,15.5412371134021,18.3247422680412,18.3247422680412,15,15,15,15,15,15],"title":["FDR: 0.037",null,"FDR: 0.051",null,null,"FDR: 0.061","FDR: 0.1","FDR: 0.097",null,null,null,"FDR: 0.053","FDR: 0.021",null,"FDR: 0.006",null,"FDR: 0.053",null,null,"FDR: 0.039",null,"FDR: 0.0032",null,"FDR: 0.1",null,"FDR: 0.079",null,null,null,"FDR: 0.037","FDR: 0.072",null,"FDR: 0.059",null,null,null,null,null,null,null,"FDR: 0.037","FDR: 0.1","FDR: 0.0098",null,null,null,"FDR: 0.097",null,"FDR: 0.059",null,null,null,"FDR: 0.0098","FDR: 0.02",null,"FDR: 0.018",null,null],"color.background":["#C70039","#581845","#C70039","#581845","#581845","#C70039","#C70039","#C70039","#581845","#581845","#581845","#C70039","#C70039","#581845","#C70039","#581845","#C70039","#581845","#581845","#C70039","#581845","#C70039","#581845","#C70039","#581845","#C70039","#581845","#581845","#581845","#C70039","#C70039","#581845","#C70039","#581845","#581845","#581845","#581845","#581845","#581845","#581845","#C70039","#C70039","#C70039","#581845","#581845","#581845","#C70039","#581845","#C70039","#581845","#581845","#581845","#C70039","#C70039","#581845","#C70039","#581845","#581845"],"color.highlight":["#C70039E5","#581845E5","#C70039E5","#581845E5","#581845E5","#C70039E5","#C70039E5","#C70039E5","#581845E5","#581845E5","#581845E5","#C70039E5","#C70039E5","#581845E5","#C70039E5","#581845E5","#C70039E5","#581845E5","#581845E5","#C70039E5","#581845E5","#C70039E5","#581845E5","#C70039E5","#581845E5","#C70039E5","#581845E5","#581845E5","#581845E5","#C70039E5","#C70039E5","#581845E5","#C70039E5","#581845E5","#581845E5","#581845E5","#581845E5","#581845E5","#581845E5","#581845E5","#C70039E5","#C70039E5","#C70039E5","#581845E5","#581845E5","#581845E5","#C70039E5","#581845E5","#C70039E5","#581845E5","#581845E5","#581845E5","#C70039E5","#C70039E5","#581845E5","#C70039E5","#581845E5","#581845E5"],"color.border":["#FFC300A5","#581845","#FFC30081","#581845","#581845","#FFC30066","#FFC30000","#FFC30007","#581845","#581845","#581845","#FFC3007B","#FFC300D0","#581845","#FFC300F7","#581845","#FFC3007B","#581845","#581845","#FFC300A0","#581845","#FFC300FF","#581845","#FFC30000","#581845","#FFC30037","#581845","#581845","#581845","#FFC300A5","#FFC30049","#581845","#FFC3006C","#581845","#581845","#581845","#581845","#581845","#581845","#581845","#FFC300A5","#FFC30000","#FFC300ED","#581845","#581845","#581845","#FFC30007","#581845","#FFC3006C","#581845","#581845","#581845","#FFC300ED","#FFC300D2","#581845","#FFC300D8","#581845","#581845"],"x":[-0.677346466665123,-0.545146235725934,-0.887475600371083,-0.733667333860307,-0.562379514397557,-0.783871163700653,-0.424730098543735,1,0.903190519467739,0.802280842948861,0.86576311917053,0.649466987083991,0.599706596728084,0.679769704740974,-0.336704464677982,-0.294438731732841,0.468167244284686,0.592345824323975,0.704763180126586,0.89910179816291,0.799992269689351,0.311919748069285,0.171060108061199,0.890253877307159,0.75182965378323,0.429402942706103,0.293490880871037,0.158014121653934,0.00489920546652711,0.311782649107363,-0.107797213115717,-0.061880525925112,-0.788440138377005,-0.899293752799147,-0.847917494939375,-0.76386494492595,-0.598299959273836,-0.451550552520881,-0.277762994156888,-0.33053338224712,-1,-0.710634310699948,0.144209904766138,-0.0313314596616439,-0.23827376072616,-0.446015882353586,-0.0328107970902961,-0.181945035883299,0.373441412285551,0.336081856364828,0.138452307234522,-0.0632072311623253,0.491129757592433,0.279894677050004,0.186994668817053,-0.151727128239891,-0.249041691528746,-0.321835884741602],"y":[0.784952263677148,0.772200263676433,0.347702915124882,0.390252704128432,0.354291269368329,0.539369373359541,0.43180801432931,0.124272206621028,0.236540603883137,0.364949437613875,0.513248140058609,0.306848985704545,0.634365012230223,0.752216109384644,0.869029684523722,1,-0.824917426784742,-0.728328421254886,-0.605537237112227,-0.368279668659434,-0.477343553012367,0.35371690338119,0.382546097954935,-0.113113838104308,-0.0645133418660967,0.938808056562248,0.86110644470856,0.964965153155344,0.931719904514566,0.698534919468567,0.623242319102828,0.77650061942686,0.024225707974308,-0.106839912202468,-0.30281100042485,-0.491588977706727,-0.61827784142554,-0.510084298333855,-0.402922670526585,-0.225311051392162,0.0239104807874821,-0.2450611830257,-0.792725007384041,-0.761819347822543,-0.79311220143892,-0.752946640887001,-1,-0.939920229342557,-0.5076187996647,-0.347023372407505,-0.303537188363344,-0.379726162895245,-0.253484452835763,0.0251916469320348,-0.118227784916997,0.229688435753052,0.101204900997237,-0.050921345783085]},"edges":{"from":["kWNpvd7y3bONibZiRJ3Z1eVaX7cENUpe","ECcBnfUZINxb5IQxVgY5ftcUh4erxOlb","xNSRkkBnzXbe7Hp2jFn0guiCc1d8O07Q","xNSRkkBnzXbe7Hp2jFn0guiCc1d8O07Q","ECcBnfUZINxb5IQxVgY5ftcUh4erxOlb","nEW35ZynkoJI0dfrDnaf4Tn8gH8i8CHK","uK9aPiKakxPueWrMsGoq7UOUZYENgYsi","AJQX134ERGVzuOCpR3ik6RefJ6CFGqXz","uK9aPiKakxPueWrMsGoq7UOUZYENgYsi","ZU60OCCULzQyvRSNFVX7Pu1T1WX2kTcO","HoTpAvj2HXengsgKqLRUDYL3yDcRJczK","dVTNb6nZ2HtfqlmlgMHglzBzGRCoxMz4","c7CKwXN6rmi5oMoUsRdFEJo2WK1hJFAv","dVTNb6nZ2HtfqlmlgMHglzBzGRCoxMz4","GkuwfcVVoZW9MaMMOF073kQp44J6NDNG","wAwFualtTsJ9DOs20p4DzfKCDhaGJHaP","87MgwCKmUiO0I08QeBYeClOP8vqlDpwU","1cPas2LcSlg4ZChW4VB3t29YYBBEsCUU","UYYS700PUZ5qJPYmOzQmCyPrFXtIfY9Q","BFXf5iOFgbwAbQ0U7cVG547yBuybs6FT","BFXf5iOFgbwAbQ0U7cVG547yBuybs6FT","1cPas2LcSlg4ZChW4VB3t29YYBBEsCUU","RqhatgfE5sPfybQXQtcuD9Sjpx8Jee87","uAknv6qkURkyOsgqa8l8r6CRN4YMcJ6Y","zM4Pv31DiJlYPuIxnOdjNipYRlQYq3e2","BMWKlJbGTMo91CUjpg1ycfLcNybpiO9j","ISnXDujbx7Fk5o372466DQMH4qhAJKhf","ZFeaANW7ewsY3vvvcT8DBYW5p87eivN2","l4Qx052d5qIp69NWgGCAg2Zta1uE0lwj","zROgo4Gjym5PHmAlOgKpffvjazKlnLaN","zROgo4Gjym5PHmAlOgKpffvjazKlnLaN","l4Qx052d5qIp69NWgGCAg2Zta1uE0lwj","ISnXDujbx7Fk5o372466DQMH4qhAJKhf","8Os9GREy9NbffS2EXu0ncXQlBflbIJBh","NNzpttgK49ZxsOQmDoRvAzQxPhRu9O0P","szmWkf8tF6G52Mz0L8gWdFPL9tzXsefR","NNzpttgK49ZxsOQmDoRvAzQxPhRu9O0P","FZgbOfv9lxAYZsMHByRYwJQphKXOJCiE","zM4Pv31DiJlYPuIxnOdjNipYRlQYq3e2","lpk736Awm0y5fLvoOGh1AkuUDLYeuEyQ","DiBv7WAkJNzHzfw9hmKnFZLSKkkB9I9P","cTsWnRLy1dKQ4ftQ2m2xI186Rm2T2E6P","cTsWnRLy1dKQ4ftQ2m2xI186Rm2T2E6P","DiBv7WAkJNzHzfw9hmKnFZLSKkkB9I9P","s8UoPlXRLhSUNOesmaMbZ9H7xeIKj9Kn","uAknv6qkURkyOsgqa8l8r6CRN4YMcJ6Y","JjpQS4eotWsHWs3ur66pyTGny9CfDMB2","WV4ICQu4FoIQkhHlmgMV7o483FNwMa62"],"to":["oMiYOzY9kdBn6GzLI2evGUSVHO0zItBM","xNSRkkBnzXbe7Hp2jFn0guiCc1d8O07Q","HleQ3SpvVpSpCtiRKpKAPven5UjMVMWy","cjV13YCAWXDXqETXx5fufzE9XerURZco","T9oWuzef31zL1S2bA1jv9p0eLas6Xtbq","uK9aPiKakxPueWrMsGoq7UOUZYENgYsi","AJQX134ERGVzuOCpR3ik6RefJ6CFGqXz","NfPUlO94ofketuKoWQyPX1jD8QYtbBof","mK97FQcG3X13Ax1KsEeEpon07Nej3Zfl","G9kLwJ9k8rBGuLXL4szfI7Egylr8ahQv","IxP25qupyWAio4UjZ9LFTd9dTTHZ3TIy","c7CKwXN6rmi5oMoUsRdFEJo2WK1hJFAv","DdQwSqSHyjJINXnY0Ti4pWQtvbnpCp4t","GkuwfcVVoZW9MaMMOF073kQp44J6NDNG","IRVg8VZEVXtQ9I0LZRQ5h9JlcDzWkc6l","OKPKrcJgI2KlfIJxraVQ5rPRyOwc8eBc","rZM9l9ITcgzuE1mEPYo07448PNBJJmRC","UYYS700PUZ5qJPYmOzQmCyPrFXtIfY9Q","BFXf5iOFgbwAbQ0U7cVG547yBuybs6FT","V0i3biAH0il1lj3f5sCiOPcLLOHGSCVt","PePmr8EedPU1V2Ew1MzrB9Fn4a7MTbbd","RqhatgfE5sPfybQXQtcuD9Sjpx8Jee87","mUVkwWimBqv7JKVI9Ts6Wa1QFxYoV2aB","zM4Pv31DiJlYPuIxnOdjNipYRlQYq3e2","BMWKlJbGTMo91CUjpg1ycfLcNybpiO9j","ISnXDujbx7Fk5o372466DQMH4qhAJKhf","ZFeaANW7ewsY3vvvcT8DBYW5p87eivN2","l4Qx052d5qIp69NWgGCAg2Zta1uE0lwj","zROgo4Gjym5PHmAlOgKpffvjazKlnLaN","N21IcwKHFJHEbDRphbUaTpIZEht1dky9","hTJJWbkBUd1bZ8yEAk4tfm2Dvi4y3xf0","RES3uxrDjLngNfxXeoqrdK8t5TukPiq8","8Os9GREy9NbffS2EXu0ncXQlBflbIJBh","NNzpttgK49ZxsOQmDoRvAzQxPhRu9O0P","szmWkf8tF6G52Mz0L8gWdFPL9tzXsefR","boCgXG6kRL0RNYayWJbDLvggkOAeMqdH","FZgbOfv9lxAYZsMHByRYwJQphKXOJCiE","jvHV2urs431zi7KnHAvhdeeMBYIEF3FO","lpk736Awm0y5fLvoOGh1AkuUDLYeuEyQ","DiBv7WAkJNzHzfw9hmKnFZLSKkkB9I9P","cTsWnRLy1dKQ4ftQ2m2xI186Rm2T2E6P","ufUKBUB59W8tQdKtGPqUXrYjZtyUs32u","VS5TWCQ4ErKDpAyCHWbuRMvbe8Wh4K5y","s8UoPlXRLhSUNOesmaMbZ9H7xeIKj9Kn","f1YAWCMH1jQ8Ry82Ym7MNalkw38VHrmX","JjpQS4eotWsHWs3ur66pyTGny9CfDMB2","WV4ICQu4FoIQkhHlmgMV7o483FNwMa62","UjSytHEeTfRnv7Sv7rRFuyoDjMVTSvGA"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","borderWidth":3,"borderWidthSelected":0,"physics":false},"manipulation":{"enabled":false},"edges":{"selectionWidth":0,"arrows":"to","smooth":false},"physics":{"stabilization":false},"interaction":{"multiselect":true,"tooltipDelay":300}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":{"text":"","style":"font-family:Helvetica"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":true,"fit":false,"resetHighlight":true,"clusterOptions":{"color":"rgba(199,0,57,1.0)"},"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/anfederico">Anthony Federico</a>, <a href="https://github.com/tetomonti">Stefano Monti</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
